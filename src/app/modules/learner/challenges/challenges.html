<section class="flex flex-col text-accent rounded-lg gap-5">
    <header class="bg-base-200 shadow-sm items-start justify-start p-5 rounded-lg font-bold">
        <h1 class="text-sm">Selecione abaixo qual módulo deseja seguir com os desafios.</h1>
    </header>

    <div class="flex flex-wrap justify-center min-h-full gap-0.5 sm:gap-2" role="list" aria-label="Lista de módulos">
        @for (module of modulesData; track module.id || $index) {
            @if (isUserModule(module.id)) {
            <app-modules-card role="listitem" class="" [data]="module" [stylesCard]="styleCardFromUser"/>
            } @else {
            <app-modules-card role="listitem" class="" [data]="module" />
            }
        }

        @if(isAuthorized) {
        <div role="listitem">
            <app-modules-card [title]="'Novo Módulo'"
                              [stylesCard]="{
                              text: styleCard.text, 
                              icon: 'ph-fill ph-plus-circle ' + styleCard.text,
                              background: styleCard.background,
                              border: styleCard.border,
                              size: 'w-40 h-70 sm:w-50 sm:h-50',
                              isNewModule: true
                            }" 
                            (clickCard)="openModal()"/>
        </div>
        }
    </div>

    <app-modal #modalCreateModule 
               [title]="'Adicionar Novo Módulo'">

        <form [formGroup]="createModuleForm" action="createModule()">
            <app-input label="Nome do Módulo" 
                       placeholder="Insira o nome do módulo"
                       formControlName="name"
                       [requiredLabel]="true"
                       [stylesInput]="inputGoldenStyle"
                       [errorMessage]="getErrorMessage('name')"
            />

            <div class="form-control mb-0">
                <app-label [label]="'Descrição'" 
                            [styleLabel]="{text: 'text-accent'}"
                            [requiredLabel]="true"/>
                <textarea placeholder="Insira a descrição do módulo aqui..." 
                          class="textarea textarea-primary w-full validator resize-none" 
                          formControlName="description"
                          [class.input-error]="createModuleForm.get('description')?.invalid && 
                                               createModuleForm.get('description')?.touched" rows="3"
                          required="true"></textarea>

                <div class="validator-hint min-h-[1rem] text-xs mt-0 text-red-600">
                    {{ createModuleForm.get('description')?.touched && 
                       createModuleForm.get('description')?.invalid ? 'Campo obrigatório' : ' ' }}
                </div>
            </div>


        <div class="flex justify-end mt-4 gap-2">
            <button class="btn btn-ghost ml-2" (click)="closeModal()">Cancelar</button>

            <app-primary-button [textButton]="'Salvar'" 
                                [r_loading]="r_loading" 
                                (click)="createModule()"/>
        </div>
        </form>

    </app-modal>

</section>